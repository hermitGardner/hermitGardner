<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>U.S. Tariff Impact Calculator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .input-group {
            margin-bottom: 15px;
        }
        input, button, select {
            padding: 8px;
            box-sizing: border-box;
        }
        button {
            background: #007BFF;
            color: white;
            border: none;
            cursor: pointer;
            margin-top: 10px;
            width: 100%;
        }
        .slider-container {
            margin: 15px 0;
        }
        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        .input-combo {
            display: flex;
            gap: 10px;
        }
        .input-combo input[type="range"] {
            flex: 1;
        }
        .input-combo input[type="number"] {
            width: 100px;
        }
        #result {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        .tariff-rate {
            font-weight: bold;
            color: #d9534f;
        }
        .category {
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        #loading, #api-status {
            display: none;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
        #loading {
            background: #e7f5ff;
        }
        .api-success {
            background: #d4edda;
        }
        .api-warning {
            background: #fff3cd;
        }
        .api-error {
            background: #f8d7da;
        }
    </style>
</head>
<body>
    <h1>U.S. Tariff Impact Calculator</h1>
    <p>Estimate how tariffs affect your spending based on real tariff rates.</p>
    
    <div class="input-group">
        <label for="income">Annual Household Income ($):</label>
        <input type="number" id="income" placeholder="e.g., 50000">
    </div>

    <h3>Adjust Annual Spending:</h3>
    
    <!-- Electronics -->
    <div class="category">
        <div class="slider-label">
            <span>Electronics (Tariff: <span id="electronics-rate" class="tariff-rate">—%</span>)</span>
        </div>
        <div class="input-combo">
            <input type="range" id="electronics-slider" min="0" max="20000" value="1000" step="100" oninput="updateSlider('electronics')">
            <input type="number" id="electronics-input" value="1000" min="0" max="100000" oninput="updateInput('electronics')">
        </div>
    </div>

    <!-- Clothing -->
    <div class="category">
        <div class="slider-label">
            <span>Clothing (Tariff: <span id="clothing-rate" class="tariff-rate">—%</span>)</span>
        </div>
        <div class="input-combo">
            <input type="range" id="clothing-slider" min="0" max="10000" value="500" step="50" oninput="updateSlider('clothing')">
            <input type="number" id="clothing-input" value="500" min="0" max="50000" oninput="updateInput('clothing')">
        </div>
    </div>

    <!-- Cars/Auto Parts -->
    <div class="category">
        <div class="slider-label">
            <span>Cars/Auto Parts (Tariff: <span id="cars-rate" class="tariff-rate">—%</span>)</span>
        </div>
        <div class="input-combo">
            <input type="range" id="cars-slider" min="0" max="30000" value="2000" step="100" oninput="updateSlider('cars')">
            <input type="number" id="cars-input" value="2000" min="0" max="100000" oninput="updateInput('cars')">
        </div>
    </div>

    <!-- Food -->
    <div class="category">
        <div class="slider-label">
            <span>Food (Tariff: <span id="food-rate" class="tariff-rate">—%</span>)</span>
        </div>
        <div class="input-combo">
            <input type="range" id="food-slider" min="0" max="20000" value="3000" step="100" oninput="updateSlider('food')">
            <input type="number" id="food-input" value="3000" min="0" max="50000" oninput="updateInput('food')">
        </div>
    </div>

    <!-- Energy (Gas, Utilities) -->
    <div class="category">
        <div class="slider-label">
            <span>Energy (Gas, Utilities) (Tariff: <span id="energy-rate" class="tariff-rate">—%</span>)</span>
        </div>
        <div class="input-combo">
            <input type="range" id="energy-slider" min="0" max="10000" value="1500" step="50" oninput="updateSlider('energy')">
            <input type="number" id="energy-input" value="1500" min="0" max="50000" oninput="updateInput('energy')">
        </div>
    </div>

    <button onclick="calculateTariffImpact()">Calculate My Tariff Costs</button>
    <div id="loading">Loading tariff data...</div>
    <div id="api-status"></div>
    <div id="result"></div>

    <script>
        // Global variable to store tariff rates
        let tariffRates = {};
        let loadingEl, statusEl, resultEl;

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Get DOM elements
            loadingEl = document.getElementById('loading');
            statusEl = document.getElementById('api-status');
            resultEl = document.getElementById('result');
            
            // Initialize calculator
            fetchTariffRates();
        });

        // Fetch tariff rates from API
        async function fetchTariffRates() {
            if (!loadingEl || !statusEl) return;
            
            loadingEl.style.display = 'block';
            statusEl.style.display = 'none';
            
            try {
                // Try to fetch rates (using mock data here - replace with real API)
                const rates = await tryFetchRates();
                tariffRates = rates;
                
                statusEl.textContent = 'Using live tariff data';
                statusEl.className = 'api-success';
                updateRateDisplays();
                
            } catch (error) {
                console.error("Failed to load rates:", error);
                statusEl.textContent = 'Using default tariff rates (API unavailable)';
                statusEl.className = 'api-warning';
                
                // Fallback rates
                tariffRates = {
                    electronics: 15,
                    clothing: 12,
                    cars: 10,
                    food: 5,
                    energy: 3
                };
                updateRateDisplays();
                
            } finally {
                loadingEl.style.display = 'none';
                statusEl.style.display = 'block';
            }
        }

        // Try to fetch rates from different sources
        async function tryFetchRates() {
            // This is where you would call real APIs
            // For now, we'll use mock data
            return {
                electronics: 15,
                clothing: 12,
                cars: 10,
                food: 5,
                energy: 3
            };
        }

        // Update displayed tariff rates
        function updateRateDisplays() {
            const categories = ['electronics', 'clothing', 'cars', 'food', 'energy'];
            categories.forEach(cat => {
                const el = document.getElementById(`${cat}-rate`);
                if (el && tariffRates[cat] !== undefined) {
                    el.textContent = `${tariffRates[cat]}%`;
                }
            });
        }

        // Sync sliders and input fields
        function updateSlider(category) {
            const slider = document.getElementById(`${category}-slider`);
            const input = document.getElementById(`${category}-input`);
            if (slider && input) {
                input.value = slider.value;
            }
        }

        function updateInput(category) {
            const slider = document.getElementById(`${category}-slider`);
            const input = document.getElementById(`${category}-input`);
            if (slider && input) {
                slider.value = input.value;
            }
        }

        // Main calculation function
        function calculateTariffImpact() {
            const income = parseFloat(document.getElementById("income").value);
            if (!income || income <= 0) {
                alert("Please enter a valid income.");
                return;
            }

            // Get spending values
            const categories = ["electronics", "clothing", "cars", "food", "energy"];
            let totalSpending = 0;
            let totalTariffCost = 0;

            let breakdown = "";
            categories.forEach(category => {
                const spend = parseFloat(document.getElementById(`${category}-input`).value) || 0;
                const rate = tariffRates[category] || 0;
                const cost = spend * (rate / 100);
                totalSpending += spend;
                totalTariffCost += cost;
                breakdown += `<li>${category.charAt(0).toUpperCase() + category.slice(1)}: $${cost.toFixed(2)} (${rate}% of $${spend})</li>`;
            });

            const percentOfIncome = (totalTariffCost / income) * 100;

            // Display result
            if (resultEl) {
                resultEl.innerHTML = `
                    <h3>Your Tariff Impact</h3>
                    <p><strong>Annual Income:</strong> $${income.toLocaleString()}</p>
                    <p><strong>Total Spending on Selected Categories:</strong> $${totalSpending.toLocaleString()}</p>
                    <p><strong>Estimated Annual Tariff Costs:</strong> $${totalTariffCost.toLocaleString(undefined, {maximumFractionDigits: 2})}</p>
                    <p><strong>% of Income Spent on Tariffs:</strong> ${percentOfIncome.toFixed(1)}%</p>
                    
                    <h4>Breakdown:</h4>
                    <ul>${breakdown}</ul>
                    
                    <p><small>Note: Calculations update each time you press "Calculate".</small></p>
                `;
            }
        }
    </script>
</body>
</html>
